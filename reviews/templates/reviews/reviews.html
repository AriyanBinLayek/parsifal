{% extends 'base_app.html' %}

{% block title %}Parsifal - {{ page_user.get_profile.get_screen_name }}{% endblock %}

{% block head_extra %}
  <link href="{{ STATIC_URL }}css/reviews.css" rel="stylesheet" media="screen">
{% endblock head_extra %}

{% block content %}
  <div class="clearfix">
    <div class="profile">
      <div class="picture">
        <img src="{{ STATIC_URL }}img/user.png" width="200px" height="200px">
      </div>
      <ul>
        {% if page_user.get_full_name %}
          <li class="full-name">{{ page_user.get_full_name }}</li>
        {% endif %}
        <li class="username">{{ page_user.username }}</li>
        <li><a href="mailto:{{ page_user.email }}">{{ page_user.email }}</a></li>
        {% if page_user.get_profile.url %}
          <li><a href="{{ page_user.get_profile.url }}">{{ page_user.get_profile.url }}</a></li>
        {% endif %}
        <li class="divider"></li>
        {% if page_user.get_profile.location %}
          <li>{{ page_user.get_profile.location }}</li>
        {% endif %}
        {% if page_user.get_profile.institution %}
          <li>{{ page_user.get_profile.institution }}</li>
        {% endif %}
        <li>Joined on {{ page_user.date_joined|date:"d M Y" }}</li>
        <li class="divider"></li>
      </ul>
      <div class="stats">
        <div>
          <h3>Following</h3>
          <span>0</span>
        </div>
        <div>
          <h3>Reviews</h3>
          <span>{{ user_reviews.count }}</span>
        </div>
        <div>
          <h3>Followers</h3>
          <span>0</span>
        </div>
      </div>
    </div>
    <div class="reviews">
      {% if user.id == page_user.id %}
        <a href="/reviews/new/" class="btn btn-success">New review</a>
      {% else %}
        <button type="button" class="btn">Follow {{ page_user.username }}</button>
      {% endif %}
      <div class="review-list">
        <h2>Published Reviews</h2>
        <table class="table no-data">
          <tbody>
            <tr>
              <td>
                {% if user.id == page_user.id %}
                  You  
                {% elif page_user.get_full_name %}
                  {{ page_user.get_full_name }}
                {% else %}
                  {{ page_user.username }}
                {% endif %}
                haven't published any systematic literature review yet.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      {% if user.id == page_user.id %}
        <div class="review-list">
          <h2>Work in Progress</h2>
          {% if user_reviews %}
            <table class="table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Authors</th>
                  <th>Last update</th>
                </tr>
              </thead>
              <tbody>
                {% for review in user_reviews %}
                  <tr>
                    <td><a href="/{{ page_user.username }}/{{ review.name }}/">{{ review.title }}</a></td>
                    <td>{{ review.author.get_full_name }}</td>
                    <td>{{ review.last_update|date:"D d M Y" }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          {% else %}
            <table class="table no-data">
              <tbody>
                <tr>
                  <td>You don't have any systematic literature review yet.</td>
                </tr>
              </tbody>
            </table>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
{% endblock content %}